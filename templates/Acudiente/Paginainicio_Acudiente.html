{% extends 'base.html' %}

{% block title %}
  Inicio - Acudiente
{% endblock %}

{% block header %}
  <header class="finisher-header d-flex align-items-center p-3 border-bottom w-100">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/Acudiente/Inicio.css') }}" />

    <h2 class="titulo-header mx-4 mb-0">| COLEGIO FE Y ALEGR칈A</h2>

    <span id="nombreUsuario" style="margin-left: auto; font-weight: bold; color: #050733ff; font-size: 35px; white-space: nowrap; flex-shrink: 0;"></span>
    <div style="margin-left: auto; display: flex; align-items: center; gap: 15px;">
    <!-- Icono notificaciones -->
    <div class="position-relative icono-header">
      <i class="bi bi-bell-fill" style="font-size: 1.2rem; cursor: pointer; color: #000000;" data-bs-toggle="dropdown" aria-expanded="false"></i>
      <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" id="contadorMensajes" style="display:none">0</span>
      <ul class="dropdown-menu dropdown-menu-end p-3" style="width: 320px;" aria-labelledby="dropdownMenuButton">
        <li class="text-center text-muted small">칔ltimas notificaciones</li>
        <div id="notificacionesRecientes" class="mt-2" style="max-height: 200px; overflow-y: auto;">
          <p class="text-center small text-secondary mb-0">Sin notificaciones recientes</p>
        </div>
      </ul>
    </div>

    <!-- Dropdown usuario -->
    <div class="dropdown icono-person">
      <button class="btn btn-usuario dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
        <span class="bi bi-person-circle"></span>
      </button>
      <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton" id="dropdownSTUDENT">
        <li><a class="dropdown-item" href="{{url_for('perfil')}}">Perfil</a></li>
        <li><a class="dropdown-item" href="{{url_for('Acudiente.manual')}}">Manual de Usuario</a></li>
        <li><hr class="dropdown-divider"></li>
        <li><a class="dropdown-item" href="{{url_for('login')}}">Cerrar sesi칩n</a></li>
      </ul>
    </div>
    </div>
  </header>

{% endblock %}

{% block extra_js %}
  <script src="{{ url_for('static', filename='js/notificaciones.js') }}"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
  <script>
  // Mostrar mensaje de bienvenida
  document.addEventListener('DOMContentLoaded', function() {
      const nombreUsuario = "{{ nombre_usuario }}";
      console.log("Nombre usuario desde Flask (crudo):", nombreUsuario);
      console.log("Tipo de dato:", typeof nombreUsuario);
      console.log("Longitud:", nombreUsuario ? nombreUsuario.length : "N/A");
      
      // Animar t칤tulo del colegio
      const tituloColegio = document.querySelector('.titulo-header');
      if (tituloColegio) {
          setTimeout(() => {
              tituloColegio.classList.add('subir');
              console.log("Clase 'subir' agregada al t칤tulo del acudiente:", tituloColegio.className);
          }, 100);
      }
      
      // Animar t칤tulo de bienvenida
      const tituloBienvenida = document.getElementById('titulo-bienvenida');
      if (tituloBienvenida) {
          setTimeout(() => {
              tituloBienvenida.style.opacity = '1';
              tituloBienvenida.style.transform = 'translateY(0)';
              console.log("Animaci칩n agregada al t칤tulo de bienvenida del acudiente");
          }, 300);
      }
      
      // Animar iconos de usuario y notificaciones
      const iconosHeader = document.querySelectorAll('.icono-header');
      if (iconosHeader.length > 0) {
          setTimeout(() => {
              iconosHeader.forEach(icono => {
                  icono.classList.add('subir');
              });
              console.log("Clase 'subir' agregada a los iconos:", iconosHeader.length, "iconos");
          }, 100);
      }
      
      // Animar icono de persona
      const iconoPersona = document.querySelector('.icono-person');
      if (iconoPersona) {
          setTimeout(() => {
              iconoPersona.classList.add('subir');
              console.log("Clase 'subir' agregada al icono-person");
          }, 100);
      }
      
      if (nombreUsuario && nombreUsuario.trim() !== "" && nombreUsuario !== "None") {
          const mensaje = "!BIENVENIDO " + nombreUsuario.toUpperCase() + "!";
          const elemento = document.getElementById('nombreUsuario');
          elemento.textContent = mensaje;
          
          console.log("Condici칩n verdadera, mostrando mensaje:", mensaje);
          
          // Animaci칩n: subir al inicio
          setTimeout(() => {
              elemento.classList.add('subir');
              console.log("Clase 'subir' agregada:", elemento.className);
          }, 100);
          
          // Esperar 7 segundos y luego bajar y desaparecer
          setTimeout(() => {
              elemento.classList.remove('subir');
              elemento.classList.add('bajar');
              console.log("Clases cambiadas a 'bajar':", elemento.className);
          }, 7100);
          
          console.log("Mensaje establecido con animaci칩n:", mensaje);
      } else {
          console.log("No hay nombre de usuario o est치 vac칤o");
          console.log("Verificando si el usuario est치 autenticado...");
          console.log("Valor de nombreUsuario:", nombreUsuario);
          console.log("Resultado de trim():", nombreUsuario ? nombreUsuario.trim() : "N/A");
          console.log("Es None?:", nombreUsuario === "None");
          
          // Mostrar informaci칩n de depuraci칩n
          const elemento = document.getElementById('nombreUsuario');
          if (elemento) {
              elemento.textContent = "!SIN USUARIO!";
              elemento.style.color = "red";
              setTimeout(() => {
                  elemento.classList.add('subir');
              }, 100);
          }
      }
  });
  </script>
{% endblock %}

{% block content %}
  <div>
    <h3 class="text-center titulo-2" id="titulo-bienvenida" style="opacity: 0; transform: translateY(30px); transition: all 4s ease;">춰BIENVENIDO A TU PANEL!</h3>
  </div>

  <!-- 游댳 CONTENIDO PRINCIPAL -->
  <div class="container my-5">
    <div class="row g-4 justify-content-center">
      <!-- TARJETAS NUEVAS DEL ESTUDIANTE -->
      <!-- 游댱 MEN칔 ACUDIENTE CON ESTILO DE TARJETAS -->
      <div class="row g-3 justify-content-center">
        <div class="col-6 col-sm-4 col-md-3 col-lg-2">
          <a href="{{ url_for('Acudiente.ver_notas') }}" class="menu-card text-decoration-none">
            <div class="card shadow-sm text-center">
              <div class="card-body">
                <i class="bi bi-list-stars menu-icon"></i>
                <p class="card-text menu-text">Notas del Estudiante</p>
              </div>
            </div>
          </a>
        </div>

        <div class="col-6 col-sm-4 col-md-3 col-lg-2">
          <a href="{{ url_for('Acudiente.ver_citaciones') }}" class="menu-card text-decoration-none">
            <div class="card shadow-sm text-center">
              <div class="card-body">
                <i class="bi bi-person-rolodex menu-icon"></i>
                <p class="card-text menu-text">Ver Citaciones del Estudiante</p>
              </div>
            </div>
          </a>
        </div>

        <div class="col-6 col-sm-4 col-md-3 col-lg-2">
          <a href="{{ url_for('Acudiente.inasistencias_justificadas') }}" class="menu-card text-decoration-none">
            <div class="card shadow-sm text-center">
              <div class="card-body">
                <i class="bi bi-journal-text menu-icon"></i>
                <p class="card-text menu-text">Inasistencias Justificadas</p>
              </div>
            </div>
          </a>
        </div>

        <div class="col-6 col-sm-4 col-md-3 col-lg-2">
          <a href="{{ url_for('Acudiente.comunicados') }}" class="menu-card text-decoration-none">
            <div class="card shadow-sm text-center">
              <div class="card-body">
                <i class="bi bi-pencil-square menu-icon"></i>
                <p class="card-text menu-text">Comunicados</p>
              </div>
            </div>
          </a>
        </div>
      </div>
      <div class="col-6 col-sm-4 col-md-3 col-lg-2">
        <a href="{{ url_for('Acudiente.ver_observador_estudiante') }}" class="menu-card text-decoration-none">
          <div class="card shadow-sm text-center">
            <div class="card-body">
              <i class="bi bi-person-workspace menu-icon"></i>
              <p class="card-text menu-text">Observador Estudiante</p>
            </div>
          </div>
        </a>
      </div>


      <div class="col-6 col-sm-4 col-md-3 col-lg-2">
        <a href="{{ url_for('Acudiente.circulares') }}" class="menu-card text-decoration-none">
          <div class="card shadow-sm text-center">
            <div class="card-body">
              <i class="bi bi-file-earmark-text menu-icon"></i>
              <p class="card-text menu-text">Circulares</p>
            </div>
          </div>
        </a>
      </div>
    </div>

    <hr class="my-5" />
    <h1 class="text-center txt-ultimo">Edunotas te acompa침a en tu proceso educativo con herramientas simples, seguras y efectivas. Creado con compromiso y tecnolog칤a por el equipo del Colegio Fe y Alegr칤a 춸 2025.</h1>
    <!-- 游댲 Secciones de noticias y circulares (sin cambios) -->
    {{ super() }}
  </div>
{% endblock %}
